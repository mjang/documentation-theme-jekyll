<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="494px" preserveAspectRatio="none" style="width:1041px;height:494px;" version="1.1" viewBox="0 0 1041 494" width="1041px" zoomAndPan="magnify"><defs><filter height="300%" id="f19bcbawdp3gnp" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="397" x="322.75" y="22.9951">Authentication on Browser-based Apps With PKCE</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="48" x2="48" y1="84.8906" y2="438.3516"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="431.5" x2="431.5" y1="84.8906" y2="438.3516"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="748.5" x2="748.5" y1="84.8906" y2="438.3516"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="967.5" x2="967.5" y1="84.8906" y2="438.3516"/><rect fill="#FEFECE" filter="url(#f19bcbawdp3gnp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="76" x="8" y="49.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="15" y="69.5889">Web App</text><rect fill="#FEFECE" filter="url(#f19bcbawdp3gnp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="76" x="8" y="437.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="15" y="457.3467">Web App</text><rect fill="#FEFECE" filter="url(#f19bcbawdp3gnp)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="389.5" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="398.5" y="53.292">End User</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="396.5" y="69.5889">(Browser)</text><rect fill="#FEFECE" filter="url(#f19bcbawdp3gnp)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="389.5" y="437.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="398.5" y="457.3467">End User</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="396.5" y="473.6436">(Browser)</text><rect fill="#FEFECE" filter="url(#f19bcbawdp3gnp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="167" x="663.5" y="49.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="153" x="670.5" y="69.5889">FRaaS Express Edition</text><rect fill="#FEFECE" filter="url(#f19bcbawdp3gnp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="167" x="663.5" y="437.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="153" x="670.5" y="457.3467">FRaaS Express Edition</text><rect fill="#FEFECE" filter="url(#f19bcbawdp3gnp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="901.5" y="49.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="908.5" y="69.5889">Resource Server</text><rect fill="#FEFECE" filter="url(#f19bcbawdp3gnp)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="901.5" y="437.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="908.5" y="457.3467">Resource Server</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="90" y1="116.0234" y2="116.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="90" x2="90" y1="116.0234" y2="129.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="49" x2="90" y1="129.0234" y2="129.0234"/><polygon fill="#A80036" points="59,125.0234,49,129.0234,59,133.0234,55,129.0234" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="55" y="110.9575">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="357" x="68" y="110.9575">Generate code verifier; create hash as a code challenge</text><polygon fill="#A80036" points="420,154.0234,430,158.0234,420,162.0234,424,158.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="426" y1="158.0234" y2="158.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="55" y="153.0903">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="68" y="153.0903">Send code challenge and code verifier</text><polygon fill="#A80036" points="737,183.1563,747,187.1563,737,191.1563,741,187.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432" x2="743" y1="187.1563" y2="187.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="439" y="182.2231">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="452" y="182.2231">Authenticate and send code challenge hash</text><polygon fill="#A80036" points="443,212.2891,433,216.2891,443,220.2891,439,216.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="437" x2="748" y1="216.2891" y2="216.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="449" y="211.356">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="255" x="462" y="211.356">Authenticate user, store code challenge</text><polygon fill="#A80036" points="59,241.4219,49,245.4219,59,249.4219,55,245.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="53" x2="431" y1="245.4219" y2="245.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="65" y="240.4888">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="78" y="240.4888">Return authorization code</text><polygon fill="#A80036" points="737,270.5547,747,274.5547,737,278.5547,741,274.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="743" y1="274.5547" y2="274.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="55" y="269.6216">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="387" x="68" y="269.6216">Send authorization code, code verifier; request access token</text><polygon fill="#A80036" points="59,299.6875,49,303.6875,59,307.6875,55,303.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="53" x2="748" y1="303.6875" y2="303.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="65" y="298.7544">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="284" x="78" y="298.7544">Confirm matching hash, return access token</text><polygon fill="#A80036" points="956,328.8203,966,332.8203,956,336.8203,960,332.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="962" y1="332.8203" y2="332.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="55" y="327.8872">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="68" y="327.8872">Request resource with access token</text><polygon fill="#A80036" points="760,357.9531,750,361.9531,760,365.9531,756,361.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="754" x2="967" y1="361.9531" y2="361.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="766" y="357.02">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="779" y="357.02">Ask to validate access token</text><polygon fill="#A80036" points="956,387.0859,966,391.0859,956,395.0859,960,391.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="749" x2="962" y1="391.0859" y2="391.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="756" y="386.1528">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="778" y="386.1528">Confirm valid access token</text><polygon fill="#A80036" points="59,416.2188,49,420.2188,59,424.2188,55,420.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="53" x2="967" y1="420.2188" y2="420.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="65" y="415.2856">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="87" y="415.2856">Return desired resource</text><!--
@startuml

title Authentication on Browser-based Apps With PKCE 
autonumber

participant "Web App" as Client
participant "End User\n(Browser)" as User
participant "FRaaS Express Edition" as Provider
participant "Resource Server" as Resource

Client->Client: Generate code verifier; create hash as a code challenge

Client->User: Send code challenge and code verifier

User->Provider: Authenticate and send code challenge hash

Provider->User: Authenticate user, store code challenge

User->Client: Return authorization code

Client->Provider: Send authorization code, code verifier; request access token

Provider->Client: Confirm matching hash, return access token

Client->Resource: Request resource with access token

Resource->Provider: Ask to validate access token

Provider->Resource: Confirm valid access token

Resource->Client: Return desired resource


@enduml

PlantUML version 1.2018.01(Sun Jan 28 10:08:22 PST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_191-8u191-b12-2ubuntu0.18.04.1-b12
Operating System: Linux
OS Version: 4.15.0-47-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>