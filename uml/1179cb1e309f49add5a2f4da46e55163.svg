<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="539px" preserveAspectRatio="none" style="width:984px;height:539px;" version="1.1" viewBox="0 0 984 539" width="984px" zoomAndPan="magnify"><defs><filter height="300%" id="fauq344kqyi1h" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="397" x="294.25" y="22.9951">Authentication on Browser-based Apps With PKCE</text><rect fill="#FFFFFF" filter="url(#fauq344kqyi1h)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="465" x="379.5" y="244.4219"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="48" x2="48" y1="84.8906" y2="482.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="431.5" x2="431.5" y1="84.8906" y2="482.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="748.5" x2="748.5" y1="84.8906" y2="482.4844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="910.5" x2="910.5" y1="84.8906" y2="482.4844"/><rect fill="#FEFECE" filter="url(#fauq344kqyi1h)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="76" x="8" y="49.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="15" y="69.5889">Web App</text><rect fill="#FEFECE" filter="url(#fauq344kqyi1h)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="76" x="8" y="481.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="62" x="15" y="501.4795">Web App</text><rect fill="#FEFECE" filter="url(#fauq344kqyi1h)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="389.5" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="398.5" y="53.292">End User</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="396.5" y="69.5889">(Browser)</text><rect fill="#FEFECE" filter="url(#fauq344kqyi1h)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="389.5" y="481.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="398.5" y="501.4795">End User</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="396.5" y="517.7764">(Browser)</text><rect fill="#FEFECE" filter="url(#fauq344kqyi1h)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="167" x="663.5" y="49.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="153" x="670.5" y="69.5889">FRaaS Express Edition</text><rect fill="#FEFECE" filter="url(#fauq344kqyi1h)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="167" x="663.5" y="481.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="153" x="670.5" y="501.4795">FRaaS Express Edition</text><rect fill="#FEFECE" filter="url(#fauq344kqyi1h)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="844.5" y="49.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="851.5" y="69.5889">Resource Server</text><rect fill="#FEFECE" filter="url(#fauq344kqyi1h)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="844.5" y="481.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="851.5" y="501.4795">Resource Server</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="90" y1="116.0234" y2="116.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="90" x2="90" y1="116.0234" y2="129.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="49" x2="90" y1="129.0234" y2="129.0234"/><polygon fill="#A80036" points="59,125.0234,49,129.0234,59,133.0234,55,129.0234" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="55" y="110.9575">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="357" x="68" y="110.9575">Generate code verifier; create hash as a code challenge</text><polygon fill="#A80036" points="420,154.0234,430,158.0234,420,162.0234,424,158.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="426" y1="158.0234" y2="158.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="55" y="153.0903">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="68" y="153.0903">Send code challenge and code verifier</text><polygon fill="#A80036" points="737,183.1563,747,187.1563,737,191.1563,741,187.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432" x2="743" y1="187.1563" y2="187.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="439" y="182.2231">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="280" x="452" y="182.2231">Authenticate and send code challenge hash</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="749" x2="791" y1="216.4219" y2="216.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="791" x2="791" y1="216.4219" y2="229.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="750" x2="791" y1="229.4219" y2="229.4219"/><polygon fill="#A80036" points="760,225.4219,750,229.4219,760,233.4219,756,229.4219" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="756" y="211.356">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="769" y="211.356">Store code challenge</text><path d="M379.5,244.4219 L555.5,244.4219 L555.5,251.4219 L545.5,261.4219 L379.5,261.4219 L379.5,244.4219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="465" x="379.5" y="244.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131" x="394.5" y="257.4888">Authenticate user</text><polygon fill="#A80036" points="443,278.5547,433,282.5547,443,286.5547,439,282.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="437" x2="748" y1="282.5547" y2="282.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="449" y="277.6216">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="462" y="277.6216">Request credentials</text><polygon fill="#A80036" points="737,307.6875,747,311.6875,737,315.6875,741,311.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="432" x2="743" y1="311.6875" y2="311.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="439" y="306.7544">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="452" y="306.7544">Supply credentials</text><polygon fill="#A80036" points="443,343.8203,433,347.8203,443,351.8203,439,347.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="437" x2="748" y1="347.8203" y2="347.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="449" y="342.8872">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="462" y="342.8872">Return authorization code</text><polygon fill="#A80036" points="59,372.9531,49,376.9531,59,380.9531,55,376.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="53" x2="431" y1="376.9531" y2="376.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="65" y="372.02">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="78" y="372.02">Pass authorization code</text><polygon fill="#A80036" points="737,402.0859,747,406.0859,737,410.0859,741,406.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="743" y1="406.0859" y2="406.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="55" y="401.1528">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="387" x="68" y="401.1528">Send authorization code, code verifier; request access token</text><polygon fill="#A80036" points="59,431.2188,49,435.2188,59,439.2188,55,435.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="53" x2="748" y1="435.2188" y2="435.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="65" y="430.2856">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="284" x="87" y="430.2856">Confirm matching hash, return access token</text><polygon fill="#A80036" points="899,460.3516,909,464.3516,899,468.3516,903,464.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="48" x2="905" y1="464.3516" y2="464.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="55" y="459.4185">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="77" y="459.4185">Request resource with access token</text><!--
@startuml

title Authentication on Browser-based Apps With PKCE 
autonumber

participant "Web App" as Client
participant "End User\n(Browser)" as User
participant "FRaaS Express Edition" as Provider
participant "Resource Server" as Resource

Client->Client: Generate code verifier; create hash as a code challenge

Client->User: Send code challenge and code verifier

User->Provider: Authenticate and send code challenge hash

Provider->Provider: Store code challenge
group Authenticate user
  Provider->User: Request credentials
  User->Provider: Supply credentials
end

Provider->User: Return authorization code

User->Client: Pass authorization code

Client->Provider: Send authorization code, code verifier; request access token

Provider->Client: Confirm matching hash, return access token

Client->Resource: Request resource with access token


@enduml

PlantUML version 1.2018.01(Sun Jan 28 10:08:22 PST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_191-8u191-b12-2ubuntu0.18.04.1-b12
Operating System: Linux
OS Version: 4.15.0-47-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>